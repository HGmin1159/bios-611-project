"0",""
"0","sim_fitznagumo <- function(t_max=250,"
"0","                           n_trials=1,"
"0","                           stimulus=c(0,0,0),"
"0","                           ic=c(-1.031463, 0.1557358)){"
"0","    data <- do.call(rbind, Map(function(trial){"
"0","        cc <- make_current(0.27+stimulus*2.5 + dumbsmooth(rnorm(length(stimulus))*0.35, 50), t_max);"
"0","        f <- fhng(current=cc);"
"0","        r <- ode(ic + 0.001*rnorm(2), times=seq(from=0,to=t_max,length.out=t_max), func=f) %>%"
"0","            as.matrix() %>%"
"0","            as_tibble() %>% rename(V=`1`, R=`2`) %>%"
"0","            mutate(across(everything(), as.numeric)) %>%"
"0","            mutate(trial=trial);"
"0","    }, seq(1:n_trials)))"
"0","    data"
"0","}"
"0","make_stim <- function(n=1000, s=50){"
"0","    stimulus <- runif(n);"
"0","    stimulus <- dumbsmooth(stimulus,s);"
"0","    stimulus"
"0","}"
"0",""
"0","fn_data <- if(file.exists(""sim2cache.csv"")){"
"0","    read_csv(""sim2cache.csv"");"
"0","} else {"
"0","    ds = rbind(sim_fitznagumo(n_trials=300, stimulus=make_stim(250,s=20)) %>%"
"0","             mutate(label=1),"
"0","             sim_fitznagumo(n_trials=300, stimulus=make_stim(250,s=20)) %>%"
"0","             mutate(label=2),"
"0","             sim_fitznagumo(n_trials=300, stimulus=make_stim(250,s=20)) %>%"
"0","             mutate(label=3));"
"0","    write_csv(ds, ""sim2cache.csv"");"
"0","    ds"
"0","}"
"2","[1mRows: [22m[34m225000[39m [1mColumns: [22m[34m5[39m"
"2","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m "",""
[32mdbl[39m (5): time, V, R, trial, label"
"2","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message."
"0","ggplot(fn_data, aes(time, V + label*3)) +"
"0","    geom_line(aes(color=factor(label), group=sprintf(""%d:%d"",label, trial)));"
"0",""
