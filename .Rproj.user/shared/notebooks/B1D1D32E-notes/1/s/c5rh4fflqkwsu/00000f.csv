"0","library(deSolve);"
"0","fhng <- function(current){"
"0","    function(t,y,p){"
"0","        V <- y[[1]];"
"0","        R <- y[[2]];"
"0","        list(c(10*(V - V*V*V - 2*R + current(t)),"
"0","               0.1*(-R + 1.25*V + 1.5)));"
"0","    }"
"0","}"
"0","make_current <- function(values,t_max){"
"0","    n <- length(values);"
"0","    function(t){"
"0","        if(t<=0) {"
"0","            values[1];"
"0","        } else if (t >= n) {"
"0","            values[n];"
"0","        } else {            "
"0","            nt <- n*t/t_max + 1;"
"0","            i_low <- max(1,floor(nt));"
"0","            i_high <- min(n,ceiling(nt));"
"0","            interp <- 1-(nt-i_low);"
"0","            values[i_low]*interp + values[i_high]*(1-interp);"
"0","        }"
"0","    }"
"0","}"
